<!-- ... (previous code unchanged) ... -->

<script>
// Splash Screen Animation & Removal
window.addEventListener('load', () => {
  const splash = document.getElementById('splash-screen');
  setTimeout(() => {
    splash.style.display = 'none';
  }, 2600); // After animations finish
});

// Theme Toggle
function toggleTheme() {
  document.body.classList.toggle('dark');
  localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
}
// Load saved theme
if (localStorage.getItem('theme') === 'dark') {
  document.body.classList.add('dark');
}

// --- Login State Management ---
let isLoggedIn = false;

// Try to restore login state from sessionStorage
if (sessionStorage.getItem('loggedIn') === 'true') {
  isLoggedIn = true;
  updateLoginUI();
}

function updateLoginUI() {
  const loginBtn = document.getElementById('loginBtn');
  if (isLoggedIn) {
    loginBtn.textContent = 'Logout';
    document.getElementById('reviewForm').querySelectorAll('input, textarea, button').forEach(el => el.disabled = false);
  } else {
    loginBtn.textContent = 'Login';
    document.getElementById('reviewForm').querySelectorAll('input, textarea, button').forEach(el => el.disabled = true);
  }
}

// Modal Login
const loginBtn = document.getElementById('loginBtn');
const loginModal = document.getElementById('loginModal');
const closeLogin = document.getElementById('closeLogin');
const loginForm = document.getElementById('loginForm');

loginBtn.addEventListener('click', () => {
  if (isLoggedIn) {
    // Logout flow
    isLoggedIn = false;
    sessionStorage.removeItem('loggedIn');
    alert('You have been logged out.');
    updateLoginUI();
  } else {
    loginModal.classList.add('show');
  }
});

closeLogin.addEventListener('click', () => {
  loginModal.classList.remove('show');
});
window.addEventListener('click', (e) => {
  if (e.target === loginModal) {
    loginModal.classList.remove('show');
  }
});

// Dummy login authentication
loginForm.addEventListener('submit', function(e) {
  e.preventDefault();
  // For demo: accept any username and password
  isLoggedIn = true;
  sessionStorage.setItem('loggedIn', 'true');
  loginModal.classList.remove('show');
  alert('Login successful! You can now submit a review.');
  updateLoginUI();
});

// Disable review form if not logged in on load
document.addEventListener('DOMContentLoaded', () => {
  updateLoginUI();
});

// Contact Form submit (dummy)
document.getElementById('contactForm').addEventListener('submit', e => {
  e.preventDefault();
  alert('Thanks for reaching out! I will get back to you soon.');
  e.target.reset();
});

// Review Form submit (add review to the page dynamically)
document.getElementById('reviewForm').addEventListener('submit', e => {
  e.preventDefault();
  if (!isLoggedIn) {
    alert('You must be logged in to submit a review.');
    return;
  }
  const name = document.getElementById('reviewName').value.trim();
  const text = document.getElementById('reviewText').value.trim();
  if(name && text){
    addReview(name, text);
    e.target.reset();
    alert('Thank you for your review!');
  }
});

// Add review to reviews container
function addReview(name, text) {
  const container = document.getElementById('reviewsContainer');
  const div = document.createElement('div');
  div.className = 'review-item';
  div.innerHTML = `<div class="review-author">${sanitize(name)}</div><div class="review-text">${sanitize(text)}</div>`;
  container.prepend(div);
}

// Simple text sanitizer
function sanitize(str) {
  return str.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");
}
</script>
</body>
</html>
